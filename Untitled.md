# 📏 TOPSIS 优劣解距离法 (Technique for Order Preference by Similarity to Ideal Solution) 知识大纲

TOPSIS 是一种常用的**综合评价方法**，其核心思想是通过计算每个评价对象与“最优解”和“最劣解”的距离来进行排序。

---

## 一、 TOPSIS 的核心逻辑 🧠

*   **基本原理**：在多指标指标空间中，寻找一个虚拟的**正理想解**（所有指标都达到最优）和**负理想解**（所有指标都达到最劣）。
*   **打分标准**：一个方案距离正理想解越近，同时距离负理想解越远，其评分就越高。
*   **客观性**：与 AHP（层次分析法）的主观打分不同，TOPSIS 能够充分利用原始数据，精确反映各方案之间的差距。

> 💡 **例子：对大学进行评级**
> 假设有四个大学，评价指标是“科研经费”。
> *   **正理想解**：经费最多的学校（100万）。
> *   **负理想解**：经费最少的学校（97万）。
> *   **打分**：经费越接近100万，评分就越接近 1；越接近 97万，评分就越接近 0。

---

## 二、 算法第一步：指标正向化 (Positiveization) 🔄

在评价时，指标的类型五花八门，必须统一转化为“越大越好”的**极大型指标**。

| 指标类型 | 特点 | 例子 | 转化方法 |
| :--- | :--- | :--- | :--- |
| **极大型** | 越大越好 | 成绩、GDP、经费 | 不需转化 |
| **极小型** | 越小越好 | 失业率、逾期率 | $max - x$ |
| **中间型** | 越接近某个值越好 | 水质pH值、师生比 | $1 - \frac{|x - x_{best}|}{M}$ |
| **区间型** | 落在某个区间最好 | 体温、生产率 | 见下方详解公式 |

> 📝 **例子：师生比（中间型指标）**
> 假设师生比越接近 0.7 越好。
> *   院校 A 比例 0.7 $\rightarrow$ 正向化后得 1 分（最优）。
> *   院校 B 比例 1.2 $\rightarrow$ 距离 0.7 较远，正向化后得分较低。

---

## 三、 算法第二步：标准化处理 (Standardization) ⚖️

由于不同指标的**单位（量纲）**不同（如：经费是“万元”，失业率是“%”），直接计算距离会产生偏差，因此需要标准化。

*   **标准矩阵 $Z$ 的计算公式**：
    $$z_{ij} = \frac{x_{ij}}{\sqrt{\sum_{i=1}^{n} x_{ij}^2}}$$
*   **目的**：消除量纲影响，使所有指标在同一数量级上进行比较。

---

## 四、 算法第三步：计算得分 (Scoring) 🔢

1.  **确定理想解**：
    *   正理想解 $Z^+$：由各列最大值组成。
    *   负理想解 $Z^-$：由各列最小值组成。
2.  **计算距离**：
    *   与正理想解的距离 $D_i^+$：$\sqrt{\sum (Z_j^+ - z_{ij})^2}$
    *   与负理想解的距离 $D_i^-$：$\sqrt{\sum (Z_j^- - z_{ij})^2}$
3.  **计算综合评价指数 $S_i$**：
    $$S_i = \frac{D_i^-}{D_i^+ + D_i^-}$$
    *   $S_i$ 越接近 1，方案越优。

---

## 五、 进阶：基于熵权法的 TOPSIS 🚀

**为什么要结合熵权法？**
在原始 TOPSIS 中，默认每个指标的权重是相等的。但在实际问题中，不同指标的重要性不同。

*   **主观赋权**：使用 AHP（由专家打分确定权重）。
*   **客观赋权**：使用 **熵权法**（依据数据的离散程度自动确定权重）。
*   **修正公式**：在计算距离 $D_i$ 时，给每一项加上权重系数 $\omega_j$：
    $$D_i^+ = \sqrt{\sum_{j=1}^{m} \omega_j (Z_j^+ - z_{ij})^2}$$

> 🏆 **大佬实战案例：2021年国赛C题**
> 在“生产企业原材料订购与运输”问题中，大佬们通过**熵权法确定指标权重**，再配合 **TOPSIS 模型**对 402 家供应商的服务质量进行综合排名，选出了最核心的 50 家供应商。

---

## 六、 总结与工具使用 🛠️

1.  **适用场景**：方案优选、绩效评价、竞争力分析等具有明确原始数据的决策问题。
2.  **常用工具**：
    *   **MATLAB**：进行矩阵运算和距离计算，效率最高（课件第38页有源码）。
    *   **Excel/SPSS**：适合处理较小的数据集，画出评分直方图或雷达图。
3.  **对比分析**：
    *   **归一化**：能使结果之和为 1。
    *   **标准化/距离法**：能使结果落到 $[0, 1]$ 区间，反映方案间的真实差距。

---
*注：课件第 27 页提供的区间型指标正向化 LaTeX 公式已在之前为您转化。*