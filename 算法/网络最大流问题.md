## 一、 核心概念：流量图 (Flow Network)

网络最大流问题研究的是在一个有向图中，如何安排从起点到终点的物流量，使得总流量达到最大。

### 1.1 基本定义
*   **流量网络**：一个有向图 $D=(V, A, C)$。
*   **容量 ($C_{ij}$)**：弧 $(V_i, V_j)$ 上允许通过的最大物流量。
*   **流量 ($x_{ij}$)**：弧 $(V_i, V_j)$ 上实际通过的物流量。
*   **发点 ($V_s$)**：物流的源头，只有出弧的节点。
*   **收点 ($V_t$)**：物流的终点，只有入弧的节点。
*   **中间点**：除了发点和收点以外的所有节点，遵循“进多少出多少”的原则。

## 二、 可行流 (Feasible Flow)

一个流量配置 $\{x_{ij}\}$ 必须满足以下两个条件才叫“可行流”：

1.  **容量条件**：$0 \le x_{ij} \le C_{ij}$。即流量不能超过管道的粗细。
2.  **平衡条件**：
    *   对于中间点：$\sum 进 = \sum 出$。
    *   对于发点和收点：$V_s$ 的净输出量 = $V_t$ 的净输入量（这被称为该可行流的**流量值**）。

---

## 三、 核心灵魂：增广链 (Augmenting Path)

增广链是解决最大流问题的关键，它是一条从 $V_s$ 到 $V_t$ 的路径，且这条路径上还有“余力”增加流量。

### 链的组成
增广链包含两种弧：
*   **前向弧**：方向与路径一致。若满足 $x_{ij} < C_{ij}$（即管道没满），则可以增加流量。
*   **反向弧**：方向与路径相反。若满足 $x_{ij} > 0$（即管道里有水），则可以通过“减少”这里的流量来腾出余力，相当于一种“反悔”机制。
![[Screenshot 2026-01-26 at 19.41.14.png]]

---

## 四、 Ford-Fulkerson 算法（标号法）

这是求解最大流的最经典算法，其核心思想是不断寻找增广链。

### 4.1 算法流程图
| 步骤 | 动作 | 说明 |
| :--- | :--- | :--- |
| **1. 初始化** | 寻找一个初始可行流 | 通常设初始流量全为 0 |
| **2. 标号过程** | 寻找增广链 | 从 $V_s$ 出发，按规则给相邻点打标签 $(+V_i, \Delta_j)$ 或 $(-V_i, \Delta_j)$ |
| **3. 判断** | 是否标到 $V_t$ | 若标到了 $V_t$，说明找到增广链，进入步骤 4；若标不下去且没到 $V_t$，当前流就是最大流 |
| **4. 调整过程** | 更新流量 | 根据增广链上的最小增量 $\Delta$，调整各弧流量，回到步骤 2 |

### 4.2 流量调整规则
*   **前向弧**：$x_{ij} = x_{ij} + \Delta$
*   **反向弧**：$x_{ij} = x_{ij} - \Delta$

---

## 五、 MATLAB 实现

在数学建模中，通常直接调用内置函数求解。

### 5.1 函数原型
`[MaxFlow, FlowMatrix, Cut] = graphmaxflow(matrix, vs, vt)`

### 5.2 参数速查表
| 参数/返回值 | 说明 |
| :--- | :--- |
| **matrix** | 有向图的稀疏矩阵（存储容量 $C_{ij}$） |
| **vs** | 起始节点编号 |
| **vt** | 目标节点编号 |
| **MaxFlow** | **最终结果：最大流量值** |
| **FlowMatrix** | 对应最大流时，每条边的实际流量 $x_{ij}$ |
| **Cut** | 最小切割位（逻辑向量），与最大流理论中的“最大流-最小割”定理相关 |

---

## 六、 总结

1.  **最大流-最小割定理**：一个网络的最大流量等于它的最小切割容量。
2.  **建模思路**：
    *   第一步：确定节点（谁是发点，谁是收点）。
    *   第二步：确定弧及其容量（管道、路宽、光纤带宽等）。
    *   第三步：构建稀疏矩阵并调用 `graphmaxflow`。
3.  **应用场景**：输油管道规划、交通流分配、电信网络带宽分配、电力调度等。