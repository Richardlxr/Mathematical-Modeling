
TOPSIS 是一种常用的**综合评价方法**，其核心思想是通过计算每个评价对象与“最优解”和“最劣解”的距离来进行排序。

---
## 一、 TOPSIS 的核心逻辑 🧠

*   **基本原理**：在多指标指标空间中，寻找一个虚拟的**正理想解**（所有指标都达到最优）和**负理想解**（所有指标都达到最劣）。
*   **打分标准**：一个方案距离正理想解越近，同时距离负理想解越远，其评分就越高。
*   **客观性**：与 AHP（层次分析法）的主观打分不同，TOPSIS 能够充分利用原始数据，精确反映各方案之间的差距。

---

## 二、 算法第一步：指标正向化 (Positiveization) 🔄

在评价时，指标的类型五花八门，必须统一转化为“越大越好”的**极大型指标**。（参考熵权法的内容）

---

## 三、 算法第二步：标准化处理 (Standardization) ⚖️

由于不同指标的**单位（量纲）** 不同（如：经费是“万元”，失业率是“%”），直接计算距离会产生偏差，因此需要标准化。

*   **标准矩阵 $Z$ 的计算公式**：
    $$z_{ij} = \frac{x_{ij}}{\sqrt{\sum_{i=1}^{n} x_{ij}^2}}$$
*   **目的**：消除量纲影响，使所有指标在同一数量级上进行比较。

---

## 四、 算法第三步：计算得分 (Scoring) 🔢

1.  **确定理想解**：
    *   正理想解 $Z^+$：由各列最大值组成。
    *   负理想解 $Z^-$：由各列最小值组成。
2.  **计算距离**：
    *   与正理想解的距离 $D_i^+$：$\sqrt{\sum (Z_j^+ - z_{ij})^2}$
    *   与负理想解的距离 $D_i^-$：$\sqrt{\sum (Z_j^- - z_{ij})^2}$
3.  **计算综合评价指数 $S_i$**：
    $$S_i = \frac{D_i^-}{D_i^+ + D_i^-}$$
    *   $S_i$ 越接近 1，方案越优。

---

## 五、 进阶：基于熵权法的 TOPSIS 🚀

**为什么要结合熵权法？**
在原始 TOPSIS 中，默认每个指标的权重是相等的。但在实际问题中，不同指标的重要性不同。

*   **主观赋权**：使用 AHP（由专家打分确定权重）。
*   **客观赋权**：使用 **熵权法**（依据数据的离散程度自动确定权重）。
*   **修正公式**：在计算距离 $D_i$ 时，给每一项加上权重系数 $\omega_j$：
    $$D_i^+ = \sqrt{\sum_{j=1}^{m} \omega_j (Z_j^+ - z_{ij})^2}$$
