## 一、 图的基本概念

### 1.1 定义与分类
*   **图的定义**：对于平面上的若干点，把这些点用曲线或直线连接起来，不考虑点的位置与连线的曲直长短，这样形成的结构即为**图**。
*   **数学表示**：$G=(V, E)$，其中 $V(vertex)$ 代表顶点的集合，$E(edge)$ 代表边的集合。
*   **分类**：
    *   **无向图**：边没有方向，类似于双向行驶的道路。
    *   **有向图**：边有特定的方向，类似于单行道，只能从起点向终点移动。

### 1.2 图的数据结构：邻接矩阵
在计算机或数学建模中，常用邻接矩阵来存储图的信息。对于一个有 $n$ 个节点的图，邻接矩阵是一个 $n \times n$ 的矩阵。

**例子**：假设有4个节点，1和2连通权重为5，1和3连通权重为10。

| 节点 | 1 | 2 | 3 | 4 |
| :--- | :--- | :--- | :--- | :--- |
| **1** | $0$ | $5$ | $10$ | $Inf$ |
| **2** | $5$ | $0$ | $Inf$ | $Inf$ |
| **3** | $10$ | $Inf$ | $0$ | $Inf$ |
| **4** | $Inf$ | $Inf$ | $Inf$ | $0$ |

*注：$Inf$ 表示两点之间没有直接路径，可以用正无穷去表示*

---

## 二、 最短路径问题的数学模型

最短路径问题旨在寻找图中两点之间权重（如距离、运费、时间）之和最小的路径。

### 2.1 整数规划表示
设决策变量为 $x_{ij}$，若弧 $v_iv_j$ 位于最短路上则 $x_{ij}=1$，否则 $x_{ij}=0$。
目标函数：$min \sum_{v_iv_j \in E} w_{ij}x_{ij}$
约束条件（流量平衡）：
$s.t. \sum_{j:v_iv_j \in E} x_{ij} - \sum_{j:v_jv_i \in E} x_{ji} = \begin{cases} 1, i=source \\ -1, i=terminal \\ 0, i \neq s,t \end{cases}$

---

## 三、 迪杰斯特拉（Dijkstra）算法

### 3.1 算法原理
Dijkstra 算法采用**贪心策略**。它维护一个从源点到各节点的当前最短距离，每次从未访问的节点中选择距离最小的一个，并以此节点为跳板更新其邻居节点的距离。

### 3.2 算法核心数组
*   **visited**：记录节点是否已固定最短路径（0为未访问，1为已访问）。
*   **distance**：记录源点到该节点的最短距离（初始为 $Inf$，源点为0）。
*   **pre**：记录该节点在最短路径上的前驱节点，用于回溯路径。

### 3.3 例子辅助理解
**场景**：从城市A到城市C。
*   路径1：$A \to C$，距离 $10$。
*   路径2：$A \to B$（距离 $2$），$B \to C$（距离 $3$）。
**过程**：
1.  初始 $dist(A)=0, dist(B)=Inf, dist(C)=Inf$。
2.  从A出发，更新邻居：$dist(B)=2, dist(C)=10$。
3.  选中当前最短的B，以B为跳板更新C：$dist(C) = min(10, dist(B)+3) = 5$。
4.  最终最短路径为 $A \to B \to C$，距离为 $5$。

### 3.4 局限性
**Dijkstra算法不能解决含有负权重的图**。
由于其贪心特性，一旦某个节点被标记为 `visited`，其距离将不再更新。但在负权图中，后续可能会出现更小的路径导致逻辑失效。

---

## 四、 负权值问题的解决方案

当图中存在负权重边时，需要使用其他算法：

| 算法名称 | 核心思想 | 特点 |
| :--- | :--- | :--- |
| **Bellman-Ford 算法** | 对所有边进行 $n-1$ 次松弛操作 | 复杂度较高，但能处理负权边并检测负权环 |
| **Floyd 算法** | 动态规划，尝试引入中间节点进行跳转 | 求出图中任意两点之间的最短路径（多源最短路） |

---

## 五、 MATLAB 实现

MATLAB 提供了内置函数 `shortestpath` 方便求解。

### 5.1 函数原型
`[P, d] = shortestpath(G, start, end, ['method', algorithm])`

### 5.2 参数说明
| 参数/返回值 | 说明 |
| :--- | :--- |
| **G** | 图对象（由 `graph` 或 `digraph` 创建） |
| **start / end** | 起点和终点的索引或名称 |
| **P** | 最短路径经过的节点序列 |
| **d** | 最短距离数值 |
| **'auto'** | 默认值，根据图的特征自动选择算法 |
| **'positive'** | 强制使用 Dijkstra 算法（要求权重非负） |
| **'mixed'** | 使用 Bellman-Ford 算法（允许负权重） |

---

## 六、 数学建模综合案例：钢管订购计划

### 6.1 问题核心
在2000年全国大学生数学建模竞赛B题中，需要从多个钢管厂订购钢管并运输到铺设线路。

### 6.2 解题思路
1.  **权值转换**：图中的原始信息是物理里程。但由于铁路和公路的运费计算方式不同（铁路通常是分段计价，公路是单价计价），不能直接用物理距离作为权重。
2.  **构建运费矩阵**：
    *   利用 Dijkstra 或 Floyd 算法分别计算各厂到各节点的“最小铁路运费”和“最小公路运费”。
    *   取两者中的较小值作为最终的边权重 $c_{ij}$。
3.  **建立数学规划模型**：
    *   **目标函数**：总费用 = 订购费 + 运输费。
    *   **约束条件**：各厂产能上限、各段线路需求量、流量平衡等。

### 6.3 关键结论
在处理复杂运输问题时，**“图论最短路”往往只是预处理步骤**，其目的是为了获得节点间的最小代价矩阵，后续通常需要配合**线性规划或整数规划**来求解全局最优解。