## 一、 什么是非线性规划？

**定义**：如果目标函数或约束条件中包含**非线性函数**（如平方、乘积、三角函数等），则该问题称为非线性规划（NLP）。

### 1. 线性 vs 非线性
| 特性 | 线性规划 (LP) | 非线性规划 (NLP) |
| :--- | :--- | :--- |
| **函数形式** | $f(x) = ax + b$ | 包含 $x^2, \sqrt{x}, \sin(x), xy$ 等 |
| **最优解** | 通常在边界或顶点取得 | 可能在区域内的任何位置取得 |
| **求解难度** | 相对容易，有全局最优解 | 容易陷入**局部最优**，难以确定全局最优 |
| **MATLAB 函数** | `linprog` | `fmincon` |

---

## 二、 MATLAB 标准型转换

与线性规划一样，MATLAB 的 `fmincon` 函数默认求解的是**最小化**问题。

### 1. 转换规则
*   **目标函数**：如果是 $\max f(x)$，需转化为 $\min (-f(x))$。
*   **不等式约束**：必须统一化为 $g(x) \le 0$。如果是 $g(x) \ge 0$，则改为 $-g(x) \le 0$。

### 2. 举例说明
**原问题**：
$\min f(x) = x_1^2 + x_2^2 + 8$
$\text{s.t. } x_1 - x_2^2 + 2 = 0$ (等式约束)

**转换后 (MATLAB 识别形式)**：
$\min f(x) = x_1^2 + x_2^2 + 8$
$\text{s.t. } -x_1 + x_2^2 - 2 = 0$

---

## 三、 MATLAB 核心求解：`fmincon`

### 1. 函数语法
```matlab
[x, val] = fmincon(@f, x0, A, b, Aeq, beq, lb, ub, @nonlfun, option)
```

### 2. 参数详细拆解
| 参数 | 含义 | 备注 |
| :--- | :--- | :--- |
| **`@f`** | 目标函数句柄 | 需要单独写一个函数文件定义非线性目标 |
| **`x0`** | **初始值** | **必填！** 非线性搜索的起点，初始值不同结果可能不同 |
| `A, b` | 线性不等式约束 | $Ax \le b$ |
| `Aeq, beq` | 线性等式约束 | $Aeq \cdot x = beq$ |
| `lb, ub` | 变量上下界 | 决策变量的取值范围 |
| **`@nonlfun`** | **非线性约束句柄** | 处理 $x^2$ 这种非线性约束，返回 `c` (≤0) 和 `ceq` (=0) |
| `option` | 算法选择 | 如 `interior-point` (内点法) 等 |

> **💡 重要技巧：如何找全局最优解？**
> 由于 `fmincon` 容易停在局部最优解，建议配合**蒙特卡洛模拟**：给不同的随机初始值 `x0` 运行多次，从中选出最好的结果。
