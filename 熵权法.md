熵权法是一种**客观赋权法**，它完全依据原始数据之间的离散程度来确定权重，避免了层次分析法（AHP）中人为打分的主观干预。

---

## 一、 核心逻辑：离散度与权重 ⚖️

*   **基本原理**：信息熵越大 $\rightarrow$ 离散程度越小 $\rightarrow$ 提供的信息量越少 $\rightarrow$ 权重越低。
*   **直观理解**：如果所有候选人的“学历”都是硕士，那么学历这个指标就无法拉开差距，它的权重就应该趋近于0。

> 💡 **例子：相亲问题**
> 甘雨相亲时考察五个指标：年龄、身高、长相、学历、收入。
> 如果 5 个候选人的“收入”差距巨大（从2000到10000），而“年龄”都差不多，那么“收入”这个指标更有助于甘雨做出区分，因此“收入”的权重会更高。

---

## 二、 第一步：指标正向化处理 (Preprocessing) 🔄

在计算之前，必须把所有类型的指标都统一转化为“越大越好”的**极大型指标**。

| 指标类型 | 特点 | 例子 | 正向化公式 (参考值) |
| :--- | :--- | :--- | :--- |
| **极大型** | 越大越好 | GDP、收入、就业率 | 不需处理 |
| **极小型** | 越小越好 | 失业率、污染指数、负债 | $max - x$ 或 $1/x$ |
| **中间型** | 越接近某个值越好 | 水质pH值、体温、满座率 | $1 - \frac{|x - x_{best}|}{M}$ |
| **区间型** | 落在某个区间最好 | 贫富差距、出生率 | 落在区间内为1，区间外按距离衰减 |

> 📝 **例子：体温指标**
> 人体正常体温 36.5℃ 最优。如果候选人 A 是 36.5℃，得分 1；如果候选人 B 是 38℃（发烧），得分就会很低。通过正向化，将“接近36.5”转化为“分值越大”。

---

## 三、 第二步：标准化处理 (Standardization) 📏

为了消除不同指标量纲（单位）的影响（比如身高是cm，收入是元），需要对数据进行标准化。

*   **公式**：$z_{ij} = \frac{x_{ij}}{\sqrt{\sum x_{ij}^2}}$ 或采用极差标准化。
*   **目的**：使所有数据落在 $[0, 1]$ 之间，方便后续概率化计算。

---

## 四、 第三步：计算熵权的过程 (Calculation) 🔢

### 1. 计算概率比重 ($p_{ij}$)
将每一列归一化，看每个样本在该指标中所占的比例。
*   $p_{ij} = \frac{z_{ij}}{\sum_{i=1}^{n} z_{ij}}$

### 2. 计算信息熵 ($e_j$)
*   $e_j = -\frac{1}{\ln n} \sum_{i=1}^{n} p_{ij} \ln(p_{ij})$
*   *注：$e_j$ 越接近 1，说明数据越平均，权重越小。*

### 3. 计算信息效用值 ($d_j$) 及 权重 ($W_j$)
*   信息效用值：$d_j = 1 - e_j$
*   归一化求权重：$W_j = d_j / \sum d_j$

---

## 五、 总结与进阶建议 🛠️

### 1. 熵权法的优缺点
*   **优点**：客观性强，有理有据，特别适合数据量大的评价类题目。
*   **缺点**：完全依赖数据。如果数据本身有偏差（比如某项数据填错了导致离散度极大），权重会产生误导。

### 2. 大佬的套路：组合赋权法 🤝
在顶级数模论文中，很少单独使用熵权法。
*   **套路**：**AHP（主观）+ 熵权法（客观）**。
*   **做法**：先用 AHP 听取专家意见，再用熵权法修正权重，最后取平均值或加权。这样既体现了人的经验，又尊重了数据的事实。

### 3. 应用场景推荐
*   高校信息化治理效能评价（如例题）。
*   生产企业供应商的选择（2021年国赛C题）。
*   环境质量评估、经济发展水平评价等。

---

> **避坑指南** ⚠️：
> 计算 $p_{ij} \ln(p_{ij})$ 时，如果 $p_{ij}=0$，$\ln(0)$ 会报错。在编程（MATLAB/Python）时，通常需要给 0 加上一个极小值（如 $1e-5$）来避免计算错误。