### 1.1 什么是拟合？
拟合（Curve Fitting）是指已知一组离散数据点$(x_i, y_i)$，寻求一个函数$y=f(x)$，使得该函数在某种准则下与所有数据点最为接近。

### 1.2 拟合与插值的区别
这是建模小白最容易混淆的点：
*   **插值**：要求函数**必须经过**每一个已知点。适用于数据非常精准的情况。
*   **拟合**：**不要求**经过每一个点，而是寻找一个总误差最小的趋势线。适用于数据带有噪声（实验误差）的情况。

| 特性 | 插值 (Interpolation) | 拟合 (Fitting) |
| :--- | :--- | :--- |
| **是否过原点** | 是 | 否（通常不过） |
| **函数形式** | 分段函数或高次多项式 | 预设的某种简单函数（如直线、指数） |
| **主要目的** | 求缺失点的值 | 发现数据背后的客观规律 |

---

## 二、 最小二乘法 (Least Squares Method)

我们要找一个函数$f(x)$，使得**残差平方和（SSE）** 达到最小：
$$J=\sum_{i=1}^{n}(f(x_i)-y_i)^2$$
通过对参数求偏导并令其为0，可以解出最优的参数。

## 三、 拟合优度 (Goodness of Fit)

如何评价拟合出来的一条线到底“好不好”？我们引入三个指标：

1.  **SST（总体平方和）**：$SST=\sum_{i=1}^n(y_i-\bar{y})^2$。反映原始数据自身的波动。
2.  **SSE（误差平方和）**：$SSE=\sum_{i=1}^n(y_i-\hat{y}_i)^2$。拟合线没解释出来的部分。
3.  **SSR（回归平方和）**：$SSR=\sum_{i=1}^n(\hat{y}_i-\bar{y})^2$。拟合线解释出来的部分。

### 3.1 决定系数 $R^2$
$$R^2=\frac{SSR}{SST}=1-\frac{SSE}{SST}$$
*   **范围**：$[0, 1]$
*   **意义**：$R^2$越接近1，说明拟合效果越好。
*   **注意**：$R^2$只适用于**对参数为线性**的拟合模型（如直线、多项式）。

---

## 四、 MATLAB 实现

### 4.1 命令行求解
对于多项式拟合：
`p = polyfit(x, y, n)`：$n$为多项式次数。
`y_fit = polyval(p, x)`：计算拟合后的数值。

### 4.2 拟合工具箱 (cftool)
在命令行输入 `cftool` 即可打开可视化工具箱。
*   **优点**：不需要写代码，直接鼠标勾选。
*   **功能**：支持线性、指数、傅里叶、高斯、自定义函数等几乎所有拟合方式。

---

## 五、 综合案例：黄河小浪底调水调沙

这是一个经典的“插值+拟合”结合的建模题目。

### 5.1 问题描述
测量了不同日期的“水流量”和“含沙量”，要求：
1.  估计任意时刻的排沙量。
2.  确定排沙量与水流量的关系。

### 5.2 建模步骤
1.  **插值预处理**：由于测量时间不均匀，先用==**三次样条插值**==补齐时间点。
2.  **数值积分**：对排沙量随时间变化的函数进行积分，求出总排沙量。
3.  **拟合建模**：观察水流量和含沙量的散点图，发现呈某种非线性趋势，利用 `cftool` 尝试不同的拟合函数（如幂函数 $y=ax^b$），并参考 $R^2$ 选择最优模型。

---

## 六、 拟合的推广：非线性转化

很多看起来是非线性的函数，可以通过**变量代换**变成线性拟合。

| 目标函数                  | 代换方法                             | 线性化结果    |
| :-------------------- | :------------------------------- | :------- |
| 指数 $y=ae^{bx}$        | 两边取对数 $ln(y)=ln(a)+bx$           | $Y=B+bx$ |
| 倒数 $y=\frac{1}{ax+b}$ | 取倒数 $1/y=ax+b$                   | $Y=ax+b$ |
| 幂函数 $y=ax^b$          | 两边取对数 $ln(y)=ln(a)+b\cdot ln(x)$ | $Y=A+bX$ |
