## 一、 插值算法概述

### 1.1 应用场景
在实际问题中，我们往往只能通过实验或观测获得有限个离散点的数据$y_i=f(x_i)$。当需要预测这些已知节点之间的其他点$x$对应的函数值时，就需要构造一个结构简单、满足一定条件的近似函数$\phi(x)$来代替$f(x)$。

**例子**：
假设气象站每隔4小时测量一次温度：
*   04:00 -> 10°C
*   08:00 -> 15°C
如果你想估计 **06:00** 的温度，就需要使用插值算法。

### 1.2 插值法的概念
设函数$y=f(x)$在区间$[a, b]$上的$n+1$个节点$x_0, x_1, \dots, x_n$处的值为$y_0, y_1, \dots, y_n$。若存在一个简单函数$\phi(x)$，使得：
$$\phi(x_i)=y_i, (i=0, 1, \dots, n)$$
则称$\phi(x)$为$f(x)$的**插值函数**，$x_i$为**插值节点**。

### 1.3 插值法定理
存在唯一的一个次数不超过$n$的多项式$P_n(x)=a_0+a_1x+\dots+a_nx^n$满足上述插值条件。其唯一性可以通过范德蒙德矩阵（Vandermonde matrix）行列式不为0来证明。

---

## 二、 常用的一维插值算法

### 2.1 分段线性插值
将每两个相邻的节点用直线段连接起来。
*   **特点**：简单直观，计算量小。
*   **缺点**：在节点处不光滑（导数不连续）。

### 2.2 拉格朗日插值法 (Lagrange)
利用拉格朗日基函数构造多项式。
*   **两个点时（线性）**：$f(x)=\frac{x-x_2}{x_1-x_2}y_1+\frac{x-x_1}{x_2-x_1}y_2$
*   **通式**：$L_n(x)=\sum_{i=0}^n y_i l_i(x)$，其中$l_i(x)=\prod_{j=0, j \neq i}^n \frac{x-x_j}{x_i-x_j}$

### 2.3 牛顿插值法 (Newton)
引入**均差（Divided Difference）** 的概念。
*   一阶均差：$f[x_i, x_j]=\frac{f(x_i)-f(x_j)}{x_i-x_j}$
*   **优点**：相比拉格朗日插值，当增加一个节点时，只需增加一项，不需要全部重新计算。

### 2.4 埃尔米特插值法 (Hermite)
不仅要求插值多项式在节点处函数值相等，还要求**一阶导数值（甚至是高阶导数值）** 也相等。
*   **效果**：比普通多项式插值更接近原函数的形态，曲线更平滑。

### 2.5 三次样条插值 (Cubic Spline)
在每个小区间内使用三次多项式，且在整个区间上满足：
1.  $\phi(x_i)=y_i$（经过所有点）。
2.  一阶导数连续。
3.  二阶导数连续。
*   **地位**：这是建模中最常用、效果最好的平滑插值方法。

---

## 三、 龙格现象 (Runge's Phenomenon)

**重要警告**：并不是插值多项式的次数越高越好。
当使用高次多项式对等距节点进行插值时，在区间的边缘处可能会出现剧烈的波动，这种现象称为**龙格现象**。

**解决方案**：
*   避免使用高次全局插值。
*   改用分段低次插值（如分段三次Hermite或三次样条）。

---

## 四、 MATLAB 实现与函数对比

### 4.1 核心函数表

| 函数名 | 算法描述 | 特点 |
| :--- | :--- | :--- |
| `pchip(x, y, new_x)` | 分段三次Hermite插值 | **保形性好**。不会出现异常波动，适合描绘物理外形。 |
| `spline(x, y, new_x)` | 三次样条插值 | **最光滑**。二阶连续可微，生成的图像视觉效果最好。 |
| `interp1(x, y, new_x, 'method')` | 一维插值通用函数 | 可选 'linear', 'nearest', 'spline', 'pchip'。 |

**例子：选择建议**
*   如果你需要曲线非常漂亮、连续性好 -> 选 `spline`。
*   如果你不希望在数据急剧变化的地方出现多余的“鼓包”或“下陷” -> 选 `pchip`。

### 4.2 二维插值
处理曲面数据，如地形海拔。
`p = interp2(x, y, z, new_x, new_y, method)`
*   **注意**：输入的`x, y`必须是网格化的（常用`meshgrid`函数处理）。